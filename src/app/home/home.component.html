<nav class="navbar navbar-expand-lg bg-dark navbar-dark">
  <div class="container-fluid">
    <a class="navbar-brand" routerLink="/home">
      <img src="assets/logo.png" width="30" height="30" class="d-inline-block align-top" alt="Brand logo" /> WaiterRobot
    </a>
    <span *ngIf="environmentType === 'dev'" class="badge bg-primary p-2">DEV</span>
    <span *ngIf="environmentType === 'testing'" class="badge bg-warning text-dark p-2">TESTING</span>
    <button
      class="navbar-toggler"
      type="button"
      data-toggle="collapse"
      (click)="toggleNav(collapsable)"
      data-target="#navbarSupportedContent"
      aria-controls="navbarSupportedContent"
      aria-expanded="false"
      aria-label="Toggle navigation"
    >
      <span class="navbar-toggler-icon"></span>
    </button>

    <div
      class="collapse navbar-collapse"
      id="navbarSupportedContent"
      #collapsable
      fxLayout="row"
      fxLayout.lt-md="column"
      fxLayoutAlign="space-between"
      fxLayoutGap="2%"
    >
      <ul class="navbar-nav">
        <li class="nav-item active">
          <a class="nav-link" routerLink="/home">Home <span class="visually-hidden">(current)</span></a>
        </li>
        <li class="nav-item">
          <a
            class="nav-link"
            routerLink="tables"
            routerLinkActive="link-active"
            [class.disabled]="!selectedOrganisation || !selectedEvent"
            >{{ 'NAV_TABLES' | tr }}</a
          >
        </li>
        <li class="nav-item">
          <a
            class="nav-link"
            routerLink="products"
            routerLinkActive="link-active"
            [class.disabled]="!selectedOrganisation || !selectedEvent"
            >{{ 'NAV_PRODUCTS' | tr }}</a
          >
        </li>
        <li class="nav-item">
          <a class="nav-link" routerLink="printers" routerLinkActive="link-active" [class.disabled]="!selectedOrganisation">{{
            'NAV_PRINTERS' | tr
          }}</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" routerLink="waiters" routerLinkActive="link-active" [class.disabled]="!selectedOrganisation">{{
            'NAV_WAITERS' | tr
          }}</a>
        </li>
      </ul>

      <ul class="navbar-nav">
        <li class="nav-item">
          <div ngbDropdown display="dynamic">
            <a class="nav-link" id="eventSwitcherDropdown" [class.disabled]="!selectedOrganisation" ngbDropdownToggle
              ><span *ngIf="!selectedEvent">{{ 'NAV_EVENTS' | tr }}</span
              ><span *ngIf="selectedEvent"
                ><b>{{ selectedEvent.name }}</b></span
              >
            </a>
            <div ngbDropdownMenu aria-labelledby="eventSwitcherDropdown">
              <button ngbDropdownItem *ngIf="selectedEvent" routerLink="events/{{ selectedEvent.id }}">
                <b>{{ selectedEvent.name }}</b
                ><small> {{ 'NAV_EDIT' | tr }}</small>
              </button>
              <ng-container *ngFor="let eventM of allEvents">
                <span
                  class="fake-dropdown-item"
                  *ngIf="eventM.id !== selectedEvent?.id"
                  (click)="onSelectEvent(eventM); $event.stopPropagation()"
                >
                  {{ eventM.name }}
                </span>
              </ng-container>
              <div class="dropdown-divider" *ngIf="selectedOrganisation || allEvents!.length > 0"></div>
              <button ngbDropdownItem routerLinkActive="active" routerLink="events/create" *ngIf="myUser?.is_admin">
                <b>+</b> {{ 'ADD_2' | tr }}
              </button>
              <button ngbDropdownItem routerLinkActive="active" routerLink="events/all">
                <bi name="gear"></bi>
                {{ 'NAV_SETTINGS' | tr }}
              </button>
            </div>
          </div>
        </li>

        <li class="nav-item">
          <div ngbDropdown display="dynamic">
            <a class="nav-link" id="organisationSwitcherDropdown" ngbDropdownToggle
              ><span *ngIf="!selectedOrganisation">{{ 'NAV_ORGANISATIONS' | tr }}</span
              ><span *ngIf="selectedOrganisation"
                ><b>{{ selectedOrganisation.name }}</b></span
              ></a
            >
            <div ngbDropdownMenu aria-labelledby="organisationSwitcherDropdown">
              <ng-container *ngIf="selectedOrganisation">
                <button ngbDropdownItem routerLink="organisations/{{ selectedOrganisation.id }}">
                  <b>{{ selectedOrganisation.name }}</b
                  ><small> {{ 'NAV_EDIT' | tr }}</small>
                </button>
                <div class="dropdown-divider"></div>
              </ng-container>
              <button ngbDropdownItem routerLinkActive="active" routerLink="organisations/create" *ngIf="myUser?.is_admin">
                <b>+</b> {{ 'ADD_2' | tr }}
              </button>
              <button ngbDropdownItem routerLinkActive="active" routerLink="organisations/all">
                <bi name="gear"></bi>
                {{ 'NAV_SETTINGS' | tr }}
              </button>
            </div>
          </div>
        </li>

        <li class="nav-item" *ngIf="myUser?.is_admin">
          <div ngbDropdown display="dynamic" placement="bottom-end">
            <a class="nav-link" id="adminDropDown" ngbDropdownToggle> {{ 'NAV_INSTANCE_ADMINISTRATION' | tr }}</a>
            <div ngbDropdownMenu aria-labelledby="adminDropDown">
              <button ngbDropdownItem routerLinkActive="active" routerLink="users">
                <bi name="person-badge"></bi>
                {{ 'NAV_USERS' | tr }}
              </button>
              <button ngbDropdownItem routerLinkActive="active" routerLink="instance">
                <bi name="gear"></bi>
                {{ 'NAV_INSTANCE_SETTINGS' | tr }}
              </button>
            </div>
          </div>
        </li>

        <li class="nav-item">
          <div ngbDropdown display="dynamic">
            <a class="nav-link" id="settingsDropdown" ngbDropdownToggle>{{ 'NAV_SETTINGS' | tr }}</a>
            <div ngbDropdownMenu aria-labelledby="settingsDropdown">
              <div class="px-3 py-1">
                <h5>{{ 'NAV_USER_SETTINGS_WELCOME' | tr }} {{ myUser?.firstname }},</h5>
                <small
                  >{{ myUser?.email_address }} <br />
                  <b *ngIf="myUser?.is_admin" class="clickable" (click)="switchAdminMode()">{{ 'NAV_USER_SETTINGS_ADMIN' | tr }}</b>
                  <b *ngIf="this.adminModeChanged" class="clickable" (click)="switchAdminMode()">{{
                    'NAV_USER_SETTINGS_ADMIN_SWITCH' | tr
                  }}</b></small
                >
              </div>
              <div class="dropdown-divider"></div>
              <button ngbDropdownItem routerLinkActive="active" routerLink="usettings/settings">
                <bi name="gear-wide-connected"></bi>
                {{ 'NAV_USER_SETTINGS' | tr }}
              </button>
              <button ngbDropdownItem routerLinkActive="active" routerLink="usettings/sessions">
                <bi name="file-lock"></bi>
                {{ 'NAV_USER_SESSIONS' | tr }}
              </button>
              <button ngbDropdownItem (click)="logout()">
                <bi name="box-arrow-left"></bi>
                {{ 'NAV_LOGOUT' | tr }}
              </button>
            </div>
          </div>
        </li>
      </ul>
    </div>
  </div>
</nav>

<main class="container-fluid text-white">
  <router-outlet></router-outlet>
</main>

<app-footer></app-footer>
